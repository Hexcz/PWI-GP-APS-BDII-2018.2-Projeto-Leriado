<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	
	<p:panel>	
		<h:form>
			<div class="row">
				<div class="col s8">
					<p:inputText id="query" value="#{amigoBean.queryAmigos}" required="true" requiredMessage="O campo de busca é obrigatório"/>
					<p:messages autoUpdate="true" for="query" id="msg-nome" globalOnly="false" />	 			
	 			</div>
	 			<div class="col s4">
	 				<h:commandLink action="#{amigoBean.buscarAmigos}">
	 					<h:graphicImage width="20" value="resources/img/lupa.png"/>
	 				</h:commandLink>	 				
	 			</div>
			</div>		
		</h:form>					
		<p:dataList value="#{amigoBean.buscados}" var="amigo" chunkSize="100">
			 <h:panelGrid id="amigo" columns="1" style="width:100%" columnClasses="logo,detail">
			 	<p:outputPanel>
			 		<div class="ui-g">
			 			<div class="ui-g-2">
						 	<p:graphicImage class="circle imgAmigo" value="#{loginBean.pathUrlImagem}#{amigo.arquivoFoto}"/>
						 </div>
						 <div class="ui-g-7">
						 	
						 	<p:outputLabel value="#{amigo.nome} #{amigo.sobrenome} "/>
						 </div>	        		
						 <div class="ui-g-3">
						 	<h:form id="formAmigo">		
						 		<h:outputLabel value="#{amigo.status}"/>					 				 	
				        		<!-- SOLICITAR AMIZADE -->				        		
								<p:commandButton									
									value="Solicitar Amizade"
									action="#{amigoBean.iniciarAmizade}"
									update="formAmigo" ajax="true"									
									rendered="#{amigo.status eq 'nada'}"
									immediate="true">
									<f:setPropertyActionListener value="#{amigo}" target="#{amigoBean.amigo}" />
								</p:commandButton>
											 							
								<!-- DESFAZER AMIZADE -->		
								<p:commandButton  rendered="#{amigo.status eq 'amigo'}"
									action="#{amigoBean.finalizarAmizade}" immediate="true"
									update="formAmigo" ajax="true"
									value="Desfazer Amizade">
									<f:setPropertyActionListener value="#{amigo}" target="#{amigoBean.amigo}" />
								</p:commandButton>								
								<!-- DESFAZER SOLICITAÇÃO -->							
								<p:commandButton  rendered="#{amigo.status eq 'enviado'}"
									action="#{amigoBean.finalizarAmizade}" immediate="true"
									update="formAmigo" ajax="true"
									value="Desfazer Solicitação">
									<f:setPropertyActionListener value="#{amigo}" target="#{amigoBean.amigo}" />
								</p:commandButton>
													
								<!-- AMIZADE FOI SOLICITADA -->		
								<h:outputLabel rendered="#{amigo.status eq 'recebida'}">
									<!-- ACEITAR SOLICITAÇÃO SOLICITADA -->	 								
									<p:commandButton value="Aceitar Solicitação"
										action="#{amigoBean.iniciarAmizade}" immediate="true"
										update="formAmigo" ajax="true">
										<f:setPropertyActionListener value="#{amigo}" target="#{amigoBean.amigo}" />
									</p:commandButton>
									<!-- RECUSAR SOLICITADA -->
									<p:commandButton value="Recusar Solicitação"
										action="#{amigoBean.finalizarAmizade}" immediate="true"
										update="formAmigo" ajax="true">
										<f:setPropertyActionListener value="#{amigo}" target="#{amigoBean.amigo}" />
									</p:commandButton>																	
								</h:outputLabel>
							</h:form>							
						</div>
					</div>					
				</p:outputPanel>
			</h:panelGrid>
		</p:dataList>					
	</p:panel> 	 	
</html>